{% extends 'StoContentBundle::layout.html.twig' %}
{% from 'MopaBootstrapBundle::flash.html.twig' import flash, advanced_flash %}

{% block title %}Профиль пользователя &middot; {{ user.username }} {% endblock %}
{% block header %}Профиль пользователя - {{ user.username }}</h4>{% endblock %}

{% block content_tag 'id="content" class="container"' %}

{% block content %}

<div class="row-fluid">
    <div class="span10 offset1">
        <div class="row-fluid">
            <div class="span9">
                <h1>Вы: <span id="user-name">{{ user.firstName }} {{ user.lastName }}, {{ user.username }}</span> </h1>
                {% if user.ratingGroup %}{{ user.ratingGroup.name }}{% endif %} - <span id="user-city">{{ user.city.name }}</span>, <span id="user-years">{{ user.years }}</span> год(а)
            </div>
            <div class="span2 offset1">
                <span style="font-size:12px;">Ваш рейтинг:</span><br />
                <i class="icon-b4c-star icon-2x"></i><span style="font-size:30px;">{{ user.rating }}</span>
            </div>
        </div>
    </div>
</div>
<hr />

<div class="row-fluid">
    <div class="span12">
        <ul class="nav nav-tabs" id="myTab">
            <li class="active" style="margin-left:80px;">
                <a href="#personal"><i class="icon-b4c-user"></i> Профиль</a>
            </li>
            <li>
                <a href="#feedbacks"><i class="icon-b4c-comment"></i> Отзывы <span class="badge badge-warning">{{ user.feedbacks|length }}</span></a>
            </li>
            <li>
                <a href="#garage"><i class="icon-b4c-garage"></i> Гараж</a>
            </li>
        </ul>
    </div>
</div>
<div class="tab-content">
    {# Profile tab #}
    <div class="tab-pane active" id="personal">
        <div class="row-fluid">
            <div class="span4">
                <center>
{% if user.avatar %}
                    <img id="avatar" src="{{ vich_uploader_asset(user, 'avatar') }}" style="width:200px" class="img-polaroid"/>
{% else %}
                    <img src="{{ asset('bundles/stocore/images/user_avatar.jpg') }}" style="width:200px" class="img-polaroid"/>
{% endif %}
                </center>
            </div>
            <div class="span8">
                {# Carousel #}
                    <div class="row-fluid">
                        <div class="span10">
                            <div id="myCarousel" class="carousel slide">
                                <ol class="carousel-indicators">
                                    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                                    <li data-target="#myCarousel" data-slide-to="1"></li>
                                    <li data-target="#myCarousel" data-slide-to="2"></li>
                                </ol>
                                <!-- Carousel items -->
                                <div class="carousel-inner">
                                    <div class="active item"><img src="{{ asset('bundles/stocore/images/notimage.png') }}" alt="" style="width: 100%; height: 300px;"  ></div>
                                    <div class="item"><img src="{{ asset('bundles/stocore/images/notimage.png') }}" alt="" style="width: 100%; height: 300px;"  ></div>
                                    <div class="item"><img src="{{ asset('bundles/stocore/images/notimage.png') }}" alt="" style="width: 100%; height: 300px;"  ></div>
                                </div>
                                <!-- Carousel nav -->
                                <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
                                <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
                            </div>
                        </div>
                    </div>
                {# EOF Carousel #}
                <h5>Общая информация</h5>
                <div class="row-fluid">
                    <div class="span10">
                        <!-- <div class="well"> -->
                        <div class="row-fluid">
                            {# Left column#}
                            <div class="span8">
                                <div class="profile-contacts" style="">
                                    <h4>Контактные данные</h4>
                                    <div class="contact-data">
                                        {% if user.contacts %}
                                        <dl class="dl-horizontal" id="contacts-list">
                                            {% for contact in user.contacts %}
                                                <dt style="text-align: left; width:80px;" data-pk="{{ contact.type.id }}" data-contact="{{ contact.id }}" data-prefix="{{ contact.type.prefix }}">{{ contact.type.name }}</dt>
                                                <dd style="margin-left: 0;" data-type-pk="{{ contact.type.id }}">
                                                    <a {#id="user-email"#} class="x-editable-contacts" href="{% if contact.type.prefix != '' %}{{contact.type.prefix}}{% endif %}{{ contact.value }}" data-pk="2" data-type="text" data-name="email" target="_blank">{{ contact.value }}</a>
                                                </dd>
                                            {% endfor %}
                                        </dl>
                                        {% endif %}
                                        <select id="all-types-select" style="display:none;"></select>
                                        <div class="well contact-edit-form" style="display:none">
                                        </div>
                                    </div>
                                </div>
                                <hr />
                                <h4>О себе</h4>
                                    {% if user.description %}
                                        <p id="description" data-type="textarea" data-pk="1" data-original-title="О себе" data-name="description">{{ user.description }}</p>
                                    {% else %}
                                        <p id="description" data-type="textarea" data-pk="1" data-original-title="О себе" data-name="description">Пользователь не оставил информации о себе.</p>
                                    {% endif %}
                            </div>
                            {# EOF Left Column #}
                            {# Right column #}
                            <div class="span4">
                                <h4>Автоклубы</h4>
                                <a href="#">Landrover Club SPB</a>
                                <p>Повторный контакт, на первый взгляд, основан на опыте. Организация практического взаимодействия, в рамках сегодняшних воззрений.</p>
                                <a href="#">Landrover Club SPB</a>
                                <p>Повторный контакт, на первый взгляд, основан на опыте. Организация практического взаимодействия, в рамках сегодняшних воззрений.</p>
                            </div>
                            {# EOF Right column #}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {# EOF Profile #}
    {# Garages tab #}
    <div class="tab-pane" id="garage">
        <div class="row-fluid">
            <div class="span10 offset1">
                {{ advanced_flash(true, 'СКОРО!', 'Данная страница находится в разработке.', false, true) }}
            </div>
        </div>
    </div>
    {# EOF Garages #}
    {# Feedbakcs tab #}
    <div class="tab-pane" id="feedbacks">
        <div class="row-fluid">
            <div class="span10 offset1">
            {% if user.feedbacks %}
                    {% for feedback in user.feedbacks %}
                    <div class="row-fluid">
                        <div class="span2">
                            <div class="thumbnail">
                                <img src="http://placehold.it/64x64">
                                <p><center>556</center></p>
                            </div>
                        </div>
                        <div class="span10">
                            <p>{{ feedback.user.username }}</p>
                            <h3>{{ feedback.user.lastName }} {{ feedback.user.firstName }}</h3>
                            <p class="row-fluid">
                                <span class="span8">
                                    {% if feedback.user.ratingGroup %}{{ feedback.user.ratingGroup.name }}{% endif %}
                                </span>
                                <span class="span4">
                                    Дата: {{ feedback.date|date("d.m.Y") }}
                                </span>
                            </p>
                            <blockquote>
                                <div class="row-fluid">
                                    <div class="span4">
                                        <input class="star" type="radio" value="1" disabled="disabled" {% if feedback.feedbackRating == 1 %} checked="checked" {% endif %}/>
                                        <input class="star" type="radio" value="2" disabled="disabled" {% if feedback.feedbackRating == 2 %} checked="checked" {% endif %}/>
                                        <input class="star" type="radio" value="3" disabled="disabled" {% if feedback.feedbackRating == 3 %} checked="checked" {% endif %}/>
                                        <input class="star" type="radio" value="4" disabled="disabled" {% if feedback.feedbackRating == 4 %} checked="checked" {% endif %}/>
                                        <input class="star" type="radio" value="5" disabled="disabled" {% if feedback.feedbackRating == 5 %} checked="checked" {% endif %}/>
                                    </div>
                                    <div class="span4">
                                    </div>
                                    <div class="span4">
                                        <p class="pull-right">
                                            <i class="icon-b4c-thumbs-up"></i> <span data-like="count">{{ feedback.pluses }}</span>
                                            <i class="icon-b4c-thumbs-down"></i> <span data-dislike="count">{{ feedback.minuses }}</span>
                                        </p>
                                    </div>
                                </div>
                                <div class="row-fluid">
                                    <p>{{ feedback.content|raw }}</p>
                                </div>
                            </blockquote>
                            {% if feedback.feedbackAnswer %}
                            <div class="row-fluid">
                                <blockquote class="well">
                                    <div class="row-fluid">
                                        <div class="span7">
                                            <p>{{ feedback.feedbackAnswer.answer|raw }}</p>
                                        </div>
                                        <div class="span5">
                                            <div class="row-fluid">
                                                <div class="span2">
                                                    <center><img src="http://placehold.it/39x39"></center>
                                                </div>
                                                <div class="span8">
                                                    <h5>{{feedback.feedbackAnswer.owner.lastName}} {{feedback.feedbackAnswer.owner.firstName}}</h5>
                                                    <p><small>Старший менеджер</small></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </blockquote>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
            {% else %}
                {{ advanced_flash(true, 'СКОРО!', 'Пользователь не оставлял отзывы.', false, true) }}
            {% endif %}
            </div>
        </div>
    </div>
    {# EOF Feedbacks #}
</div>
{% endblock %}

{% block foot_script %}
{{ parent() }}
    <script>
    $('#myTab a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
    });
    </script>
{% endblock %}
