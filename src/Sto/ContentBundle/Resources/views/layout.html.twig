<!DOCTYPE HTML>
<html lang="ru">
    <head>
        <meta charset="utf-8">
        <title>{% block title 'Best4Car' %}</title>

        {% block css %}
            {% stylesheets
                'bootstrap/css/bootstrap.css'
                'bootstrap/css/bootstrap-select.css'
                'bootstrap/css/chosen.css'
                'bootstrap/css/style.css'
                'bootstrap/css/style-po-ups.css'
                output='compiled/compiled.css'
            %}
                <link href="{{ asset_url }}" type="text/css" rel="stylesheet" media="screen" />
            {% endstylesheets %}
        {% endblock %}
        <link rel="stylesheet" href="{{ asset('bootstrap/css/custom.css') }}">

        <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic|PT+Sans+Narrow|PT+Sans+Caption&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Ubuntu&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <!--[if IE 7 ]><html class="ie7"> <![endif]-->
        <!--[if IE 8 ]><html class="ie8"> <![endif]-->
        <!--[if IE 9 ]><html class="ie9"> <![endif]-->
        <!--[if (gte IE 10)|!(IE)]><!--><html> <!--<![endif]-->

        <link rel="icon" href="/favicon.ico">

        {% block js %}
            {% javascripts
                'bootstrap/js/jquery.js'
                'bootstrap/js/jquery-ui-1.10.3.custom.js'
                'bootstrap/js/bootstrap.js'
                'bootstrap/js/jquery.mousewheel.js'
                'bootstrap/js/jquery.jscrollpane.js'
                'bootstrap/js/jquery.bxslider.min.js'
                'bootstrap/js/jquery.reveal.js'
                'bootstrap/js/selectbox.js'
                'bootstrap/js/selectbox1.js'
                'bootstrap/js/bootstrap-datetimepicker.min.js'
                'bootstrap/js/cookie.js'
                'bootstrap/js/custom.js'
                'bootstrap/js/custom.city-choice.js'
                'bootstrap/js/chosen.jquery.js'
                output='compiled/compiled.js'
            %}
            <script type="text/javascript" src="{{ asset_url }}"></script>
            {% endjavascripts %}
        {% endblock %}
        <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}" type="text/javascript"></script>
        <script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>
    <body>
        {% block wrap_container_open %}<div class="main">{% endblock %}
        {% block map %}{% endblock %}
        <header id="header">
            <div class="topHeader">
                <div class="logoCont">
                    <h1 class="logo"><a class="logoLink" href="{{ path('_index') }}">best4car</a></h1>
                    <p class="slogan"><img src="{{ asset('/bootstrap/img/slogan.png') }}" alt="Автоэксперты рекомендуютлучшее для вашего авто!" /></p>
                </div>
                {% block navbar %}
                <div class="navCont">
                    {{ knp_menu_render('StoContentBundle:Builder:mainMenu', {'currentAsLink': true}) }}
                </div>
                {% endblock %}
                {% block signup %}
                    {% render controller('StoContentBundle:User:logedInUserProfileDropDown') %}
                {% endblock %}
            </div>
            <div class="bottomHeader row-fluid">
                {% block bottomHeaderWraperBlockStart %}<div class="bottomHeaderCont">{% endblock %}
                {% block pageTitle %}{% endblock %}
                <div class="tounCont">
                    {% render controller('StoContentBundle:ChoiceCity:renderChosenCity') %}
                </div>
                {% block search %}
                    <div class="searchWrap">
                        <div class="searchCont" id="searchWrapper">
                            <form class="form-search" action="{{ path('_index') }}" method="GET">
                                <label class="control-label" for="search">Я ищу:</label>
                                    <input type="text" id="inputSearch" class="input-medium search-query empty" placeholder="Все компании" name="search" value="{{ app.request.query.get('search') }}">
                                <p class="searchExample">Например:
                                <i class="btnLeft icon-white"></i>
                                <i class="btnRight icon-white"></i>
                                <span class="exampleName" id="variantContainer">ремонт двигателя Mazda3 спб</span></p>
                                {% render controller('StoContentBundle:Company:searchVariants') %}
                                <button type="submit" href="#" class="btnSearch">
                                    <i class="iconSearch icon-search icon-white"></i>Найти
                                </button>
                            </form>
                        </div>
                    </div>
                {% endblock %}
            </div>
            {% block contentTop %}{% endblock %}
            {% block bottomHeaderWraperBlockEnd %}</div>{% endblock %}
        </header>
        {% block content %}{% endblock %}
        <section class="footer">
            <div class="fotterCont">
                <p class="footerLogo"></p>
                {{ knp_menu_render('StoContentBundle:Builder:footerMenu', {'currentAsLink': true}) }}
                {{ knp_menu_render('StoContentBundle:Builder:footerSocial', {'currentAsLink': true}) }}
                <div id="linkUser"><a href="{{ path('info_show', {'name': 'useRules'}) }}">Условия использования сайта</a></div>
            </div>
        </section>
        {% if not app.user %}
            <div id="registration-popup" class="reveal-modal">
                <a href="#" class="close-reveal-modal"></a>
                <p class="popUpTitle">Регистрация на best4car.ru</p>
                <p class="popUpTitle2">Кем вы хотите зарегистрироваться?</p>
                <a href="#" class="btnHowReg btnRegPeople" id="carOwnerRegister">
                    <i class="iconPeople"></i>
                    <span>Автовладельцем</span>
                </a>
                <a href="{{ path('registration_company_owner') }}" class="btnHowReg btnRegComp">
                    <i class="iconCompany"></i>
                    <span>Представителем компании</span>
                </a>
            </div>

            <div id="resetting-popup" class="reveal-modal resetting-modal">
                <a href="#" class="close-reveal-modal"></a>
                <p class="popUpTitle">Для восстановления пароля введите адрес электронной почты.</p>
                <div id="resetting-container"></div>
            </div>

            <div id="registration-form-popup" class="reveal-modal registration-popup">
                <a href="#" class="close-reveal-modal"></a>
                <p class="popUpTitle">Регистрация на best4car.ru</p>
                <div id="registration-container"></div>
            </div>

            <div id="not-loged-in" class="reveal-modal">
                <a href="#" class="close-reveal-modal"></a>
                <div class="formWrapper">{% render controller('StoUserBundle:User:userLogin') %}</div>
                <script>
                    $(document).ready(function(){
                        var link = $('#not-loged-in .regisrationLink'),
                            id = link.data('reveal-id');

                        link.attr('data-reveal', id)
                            .removeData('reveal-id')
                            .removeAttr('data-reveal-id')
                        ;

                        $('#not-loged-in').on('submit', 'form', function(e){
                            e.preventDefault();
                            var $this = $(this),
                                $loginFormWrapper = $('#not-loged-in .formWrapper');

                            $.ajax({
                                type: "POST",
                                url: $this.attr('action'),
                                data: $this.serialize(),
                                success: function(responce) {
                                    if (responce.indexOf('<!DOCTYPE HTML>') == 0) {
                                        window.location.reload();
                                    } else {
                                        $loginFormWrapper.html(responce);
                                    }
                                }
                            });
                        });
                        $('#not-loged-in').on('click', '.regisrationLink', function(){
                            $(this).parents('.reveal-modal').trigger('reveal:close');
                            $('#' + $(this).data('reveal')).reveal($(this).data());
                        });
                    });
                </script>
            </div>
        {% endif %}
        {% block wrap_container_close %}</div>{% endblock %}

        <script type="text/javascript">
            $(document).ready(function() {
                $('.cardCompanyItem').click(function() {
                    $('#blocBig_' + this.id).slideToggle(0);
                    $('#blocSmall_' + this.id).slideToggle(0);
                });
            });
            $(document).ready(function(){
                $('.typeahead').typeahead()
            });
        </script>
    </body>
</html>
