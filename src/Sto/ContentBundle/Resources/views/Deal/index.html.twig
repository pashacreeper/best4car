{% extends 'StoContentBundle::layout.html.twig' %}
{% from 'MopaBootstrapBundle::flash.html.twig' import flash %}

{% block title 'Акции' %}

{% block aside %}
<div class="container">
    <div class="well">
        <form class="form-search form-inline" style="margin-bottom:5px;">
            Я ищу акцию:
            <div class="input-append">
                <input type="text" class="search-query span9" placeholder="Все акции">
                <button type="submit" class="btn btn-primary">Найти</button>
            </div>
        </form>
        <p style="font-size:10px; margin-left:120px;">
            Напрмер: <a href="#">ремонт двигателя, Mazda 3, 1.6, 2010, север спб</a>
        </p>
    </div>

    <aside class="visible-desktop">
        <ul class="sideMenu">
{% for dealsType in dictionaries %}
            <li>
                <a href="#">{{ dealsType.name }}</a>
                <span>{{ dealsType.deals|length }}</span>
            </li>
{% endfor %}
        </ul>
    </aside>
{% endblock %}
{% block content_tag 'id="content" class="deals-index"' %}

{% block content %}
    <div class="row-fluid">
    <h3 class=" span9 offset1">
        Лучшие спецпредложения города
    </h3>
    <div class="row-fluid">
        <div id="myCarousel" class="carousel slide span12">
              <ol class="carousel-indicators">
                <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                <li data-target="#myCarousel" data-slide-to="1"></li>
                <li data-target="#myCarousel" data-slide-to="2"></li>
              </ol>
              <!-- Carousel items -->
              <div class="carousel-inner">
                {% for deal in [random(deals), random(deals), random(deals)] %}
                    <div class="item {% if loop.first %}active{% endif %}">
                        <img src="/../{{ storage_path }}/deal_image/{{ deal.imageName }}" class="img-polaroid" style="width: 100%; height: 40%;">
                        <div class="carousel-caption">
                            <a href="{{ path('content_deal_show', {'id': deal.id }) }}"><h4>{{ deal.name }}</h4></a>
                            <p>{{ deal.company }}</p>
                        </div>
                    </div>
                {% endfor %}
              </div>
              <!-- Carousel nav -->
              <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
              <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
        </div>
    </div>
    <div class="row-fluid">

    <div class="span12">
        {% set full_count = deals|length // 10 %}
        {% set rem = deals|length % 10 %}
        {% set full_circles = full_count*10 %}

        {% if full_count > 0 %}
            {% for i in range(0, full_circles-1, 10) %}
                <div class="row-fluid">
                    <div class="span6">
                        <div class="row-fluid">
                            <div class="span12">
                                <a href="{{ path('content_deal_show', {'id': deals[i].id }) }}">
                                    <img src="/../{{ storage_path }}/deal_image/{{ deals[i].imageName }}" class="img-polaroid" />
                                    <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i].name}}
                                    </div>
                                </a>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span6">
                                <a href="{{ path('content_deal_show', {'id': deals[i+1].id }) }}">
                                <img src="/../{{ storage_path }}/deal_image/{{ deals[i+1].imageName }}" class="img-polaroid">
                                <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+1].name}}
                                    </div>
                                </a>
                            </div>
                            <div class="span6">
                                <a href="{{ path('content_deal_show', {'id': deals[i+2].id }) }}">
                                <img src="/../{{ storage_path }}/deal_image/{{ deals[i+2].imageName }}" class="img-polaroid">
                                <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+2].name}}
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="span6">
                        <div class="row-fluid">
                            <div class="span6">
                                <a href="{{ path('content_deal_show', {'id': deals[i+3].id }) }}">
                                <img src="/../{{ storage_path }}/deal_image/{{ deals[i+3].imageName }}" class="img-polaroid">
                                <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+3].name}}
                                    </div>
                                </a>
                            </div>
                            <div class="span6">
                                <a href="{{ path('content_deal_show', {'id': deals[i+4].id }) }}">
                                <img src="/../{{ storage_path }}/deal_image/{{ deals[i+4].imageName }}" class="img-polaroid">
                                <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+4].name}}
                                    </div>
                                </a>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span12">
                                <a href="{{ path('content_deal_show', {'id': deals[i+5].id }) }}">
                                <img src="/../{{ storage_path }}/deal_image/{{ deals[i+5].imageName }}" class="img-polaroid">
                                <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+5].name}}
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span3">
                        <a href="{{ path('content_deal_show', {'id': deals[i+6].id }) }}">
                        <img src="/../{{ storage_path }}/deal_image/{{ deals[i+6].imageName }}" class="img-polaroid">
                        <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+6].name}}
                                    </div>
                        </a>
                    </div>
                    <div class="span3">
                        <a href="{{ path('content_deal_show', {'id': deals[i+7].id }) }}">
                        <img src="/../{{ storage_path }}/deal_image/{{ deals[i+7].imageName }}" class="img-polaroid">
                        <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+7].name}}
                                    </div>
                        </a>
                    </div>
                    <div class="span3">
                        <a href="{{ path('content_deal_show', {'id': deals[i+8].id }) }}">
                        <img src="/../{{ storage_path }}/deal_image/{{ deals[i+8].imageName }}" class="img-polaroid">
                        <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+8].name}}
                                    </div>
                        </a>
                    </div>
                    <div class="span3">
                        <a href="{{ path('content_deal_show', {'id': deals[i+9].id }) }}">
                        <img src="/../{{ storage_path }}/deal_image/{{ deals[i+9].imageName }}" class="img-polaroid">
                        <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+9].name}}
                                    </div>
                        </a>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if rem > 0 %}
            {% set i = full_circles %}
            <div class="row-fluid">
                <div class="span6">
                    <div class="row-fluid">
                        <div class="span12">
                            {% if deals[i] is defined %}
                                <a href="{{ path('content_deal_show', {'id': deals[i].id }) }}">
                                <img src="/../{{ storage_path }}/deal_image/{{ deals[i].imageName }}" class="img-polaroid">
                                <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i].name}}
                                    </div>
                                </a>
                             {% endif %}
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6">
                            {% if deals[i+1] is defined %}
                            <a href="{{ path('content_deal_show', {'id': deals[i+1].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+1].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+1].name}}
                                    </div>
                            </a>
                            {% endif %}
                        </div>
                        <div class="span6">
                            {% if deals[i+2] is defined %}
                            <a href="{{ path('content_deal_show', {'id': deals[i+2].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+2].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+2].name}}
                                    </div>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="span6">
                    <div class="row-fluid">
                        <div class="span6">
                            {% if deals[i+3] is defined %}
                            <a href="{{ path('content_deal_show', {'id': deals[i+3].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+3].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+3].name}}
                                    </div>
                            </a>
                            {% endif %}
                        </div>
                        <div class="span6">
                            {% if deals[i+4] is defined %}
                            <a href="{{ path('content_deal_show', {'id': deals[i+4].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+4].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+4].name}}
                                    </div>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            {% if deals[i+5] is defined %}
                            <a href="{{ path('content_deal_show', {'id': deals[i+5].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+5].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+5].name}}
                                    </div>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span3">
                    {% if deals[i+6] is defined %}
                        <a href="{{ path('content_deal_show', {'id': deals[i+6].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+6].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+6].name}}
                                    </div>
                        </a>
                    {% endif %}
                </div>
                <div class="span3">
                    {% if deals[i+7] is defined %}
                        <a href="{{ path('content_deal_show', {'id': deals[i+7].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+7].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+7].name}}
                                    </div>
                        </a>
                    {% endif %}
                </div>
                <div class="span3">
                    {% if deals[i+8] is defined %}
                        <a href="{{ path('content_deal_show', {'id': deals[i+8].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+8].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                        {{deals[i+8].name}}
                                    </div>
                        </a>
                    {% endif %}
                </div>
                <div class="span3">
                    {% if deals[i+9] is defined %}
                        <a href="{{ path('content_deal_show', {'id': deals[i+9].id }) }}">
                            <img src="/../{{ storage_path }}/deal_image/{{ deals[i+9].imageName }}" class="img-polaroid">
                            <div style="position:relative; width:auto; bottom:45px; left:10px;">
                                {{deals[i+9].name}}
                            </div>
                        </a>
                    {% endif %}
                </div>
            </div>
        {% endif %}
    </div>
    </div>
</div>
</div>

{% endblock %}
