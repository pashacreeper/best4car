{% extends 'StoAdminBundle::layout.html.twig' %}
{% from 'MopaBootstrapBundle::flash.html.twig' import flash %}

{% block title %}Редактирование акции{% endblock %}

{% block header %}<h4>{{ block('title') }}</h4>{% endblock %}

{% block head_script %}
    {{ parent() }}
{% endblock %}

{% block content %}
<form action="{{ path('deal_update', { 'id': deal.id }) }}" method="post" {{ form_enctype(edit_form) }} class="form-horizontal">
    <div class="row-fluid">
        <div class="span6">
            {{ form_row(edit_form.name) }}
            {{ form_row(edit_form.company) }}
            {{ form_row(edit_form.type) }}
        </div>
        <div class="span6">
            <div class=" control-group">
                <label class="control-label required">
                    Сроки акции
                </label>
                <div class="controls">
                    {{ form_errors(edit_form.startDate) }}
                    {{ form_widget(edit_form.startDate) }}
                    {{ form_errors(edit_form.endDate) }}
                    {{ form_widget(edit_form.endDate) }}
                </div>
            </div>
            <div class=" control-group">
                <label class="control-label required">
                    Время акции
                </label>
                <div class="controls">
                    {{ form_errors(edit_form.startTime) }}
                    {{ form_widget(edit_form.startTime) }}
                    {{ form_errors(edit_form.endTime) }}
                    {{ form_widget(edit_form.endTime) }}
                </div>
            </div>
            {{ form_row(edit_form.auto) }}
        </div>
    </div>
    <div class="row-fluid">
        {{ form_row(edit_form.description) }}
    </div>
    <hr style="margin: 0 0 20px 0;">
    <div class="row-fluid">
        <div class="span3 offset2">
            <div class="control-group">
                <div class="control">
{% if not form_errors(edit_form.image) and deal.imageName %}
                    <img data-image="image1" src="{{ vich_uploader_asset(deal,'image') | imagine_filter('deal_filter') }}" class="img-polaroid"/>
{% else %}
                    <img data-image="image1" src="{{ asset('bundles/stocore/images/notimage.png') }}" style="width:120px" class="img-polaroid"/>
{% endif %}
                    {{ form_errors(edit_form.image) }}
                    {{ form_widget(edit_form.image) }}
                </div>
            </div>
        </div>
        <div class="span3">
            <div class="control-group">
                <div class="control">
{% if not form_errors(edit_form.image2) and deal.imageName2 %}
                        <img data-image="image2" src="{{ vich_uploader_asset(deal,'image2') | imagine_filter('deal_filter') }}" class="img-polaroid"/>
{% else %}
                        <img data-image="image2" src="{{ asset('bundles/stocore/images/notimage.png') }}" style="width:120px" class="img-polaroid"/>
{% endif %}
                    {{ form_errors(edit_form.image2) }}
                    {{ form_widget(edit_form.image2) }}
                </div>
            </div>
        </div>
        <div class="span3">
            <div class="control-group">
                <div class="control">
{% if not form_errors(edit_form.image3) and deal.imageName3 %}
                        <img data-image="image3" src="{{ vich_uploader_asset(deal,'image3') | imagine_filter('deal_filter') }}" class="img-polaroid"/>
{% else %}
                        <img data-image="image3" src="{{ asset('bundles/stocore/images/notimage.png') }}" style="width:120px" class="img-polaroid"/>
{% endif %}
                    {{ form_errors(edit_form.image3) }}
                    {{ form_widget(edit_form.image3) }}
                </div>
            </div>
        </div>
    </div>
    <hr style="margin: 0 0 20px 0;">
    <div class="row-fluid">
        <div class="span12">
            {{ form_row(edit_form.autoServices) }}
        </div>
    </div>
    <div class="row-fluid">
        <div class="span6">
            {{ form_row(edit_form.place) }}
        </div>
        <div class="span6">
            {{ form_row(edit_form.terms) }}
        </div>
    </div>
    {{ form_widget(edit_form) }}
    <div class="form-actions">
        <input type="submit" class="btn btn-primary" value="{{ 'form.save'|trans({}) }}" />
        <a href="{{ path('deals') }}" class="btn">{{ 'form.cancel'|trans({}) }}</a>
    </div>
</form>
{% endblock %}

{% block foot_script %}
{{ parent() }}
{% javascripts
    'bundles/stocore/js/select2.js'
    'bundles/stocore/js/bootstrap-inputmask.js'
    'bundles/stoadmin/js/script.js'
%}
    <script type="text/javascript" src="{{ asset_url }}"></script>
{% endjavascripts %}
<script type="text/javascript">
    $(".select2").select2({});
</script>
{% endblock %}
