{% extends 'StoAdminBundle::layout.html.twig' %}
{% from 'MopaBootstrapBundle::flash.html.twig' import flash %}

{% block title %}Новая акция{% endblock %}

{% block header %}<h4>{{ block('title') }}</h4>{% endblock %}

{% block content %}
<form action="{{ path('deal_create') }}" method="post" {{ form_enctype(form) }} class="form-horizontal">
    <div class="row-fluid">
        <div class="span6">
            {{ form_row(form.name) }}
            {{ form_row(form.company) }}
            {{ form_row(form.type) }}
        </div>
        <div class="span6">
            <div class=" control-group">
                <label class="control-label required">
                    Сроки акции
                </label>
                <div class="controls">
                    {{ form_errors(form.startDate) }}
                    {{ form_widget(form.startDate) }}
                    {{ form_errors(form.endDate) }}
                    {{ form_widget(form.endDate) }}
                </div>
            </div>
            <div class=" control-group">
                <label class="control-label required">
                    Время акции
                </label>
                <div class="controls">
                    {{ form_errors(form.startTime) }}
                    {{ form_widget(form.startTime) }}
                    {{ form_errors(form.endTime) }}
                    {{ form_widget(form.endTime) }}
                </div>
            </div>
        </div>
    </div>
    <div class="row-fluid">
        {{ form_row(form.description) }}
    </div>
    <hr style="margin: 0 0 20px 0;">
    <div class="row-fluid">
        <div class="span3 offset2">
            <div class="control-group">
                <div class="control">
                    <img data-image="image1" src="{{ asset('bundles/stocore/images/notimage.png') }}" style="width:120px" class="img-polaroid"/>
                    {{ form_errors(form.image) }}
                    {{ form_widget(form.image) }}
                </div>
            </div>
        </div>
        <div class="span3">
            <div class="control-group">
                <div class="control">
                    <img data-image="image2" src="{{ asset('bundles/stocore/images/notimage.png') }}" style="width:120px" class="img-polaroid"/>
                    {{ form_errors(form.image2) }}
                    {{ form_widget(form.image2) }}
                </div>
            </div>
        </div>
        <div class="span3">
            <div class="control-group">
                <div class="control">
                    <img data-image="image3" src="{{ asset('bundles/stocore/images/notimage.png') }}" style="width:120px" class="img-polaroid"/>
                    {{ form_errors(form.image3) }}
                    {{ form_widget(form.image3) }}
                </div>
            </div>
        </div>
    </div>
    <hr style="margin: 0 0 20px 0;">
    <div class="row-fluid">
        <div class="span12">
            {{ form_row(form.services) }}
        </div>
    </div>
    <div class="row-fluid">
        <div class="span6">
            {{ form_row(form.place) }}
        </div>
        <div class="span6">
            {{ form_row(form.terms) }}
        </div>
    </div>
    {{ form_widget(form) }}
    <div class="form-actions">
        <input type="submit" class="btn btn-primary" value="{{ 'form.create'|trans({}) }}" />
        <a href="{{ path('deals') }}" class="btn">{{ 'form.cancel'|trans({}) }}</a>
    </div>
</form>
{% endblock %}

{% block foot_script %}
{{ parent() }}
{% javascripts
    'bundles/stocore/js/select2.js'
    'bundles/stocore/js/bootstrap-inputmask.js'
%}
    <script type="text/javascript" src="{{ asset_url }}"></script>
{% endjavascripts %}
<script type="text/javascript" >
    $('[data-image]').click().change(function () {
        if (this.files && this.files[0]) {
            var img_data = $(this).data('image');
            var reader = new FileReader();
            reader.onload = function (e) {
                $('[data-image="'+img_data+'"]').attr('src', e.target.result);
            }
            reader.readAsDataURL(this.files[0]);
         }
     });

    $(".select2").select2({
    });
</script>
{% endblock %}
